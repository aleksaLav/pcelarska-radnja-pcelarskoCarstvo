function ispisProizvoda(e){let n="";e.forEach(e=>{1==e.prioritet&&(n+=`\n            <div class="col-xl-2 col-lg-3 col-md-5 col-sm-11 text-break border mb-1 m-2">\n                <img src="${e.slika.src}" class="w-100" />\n                <p class="pt-2">${e.naziv}</p>\n                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 pt-2 d-flex justify-content-centar">\n                ${function(e){return e?"<b class='zelena text-center'>na stanju</b>":"<b class='crvena text-center'>trenutno nije na stanju</b>"}(e.naStanju)}\n            </div>\n                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 pt-2 pb-3 d-flex justify-content-around flex-wrap">\n                    <span class="novaCena"><b>${e.cena.nova} rsd</b></span><del>\n                    ${function(e,n){return e==n?"":e+" rsd"}(e.cena.stara,e.cena.nova)}\n                    </del>\n                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 pt-2 pb-3">\n                         <button id="korpa" class="korpa btn border border-dark" data-id="${e.id}"  data-stanje="${e.naStanju}">dodaj u korpu</button>\n                    </div>\n                </div>\n            </div>\n            `)}),document.getElementById("proizvodi").innerHTML=n,$(".korpa").click(DODAJuKORPU)}function ispis(e){let n="";e.forEach(e=>{n+=`\n        <div class="col-xl-2 col-lg-3 col-md-5 col-sm-11 text-break border mb-1 m-2">\n              <img src="${e.slika.src}" class="w-100" />\n              <p>${e.naziv}</p>\n              <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 d-flex justify-content-centar">\n              ${function(e){return e?"<b class='zelena text-center'>na stanju</b>":"<b class='crvena text-center'>trenutno nije na stanju</b>"}(e.naStanju)}\n        </div>\n            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 d-flex justify-content-around flex-wrap">\n                <span class="novaCena">${e.cena.nova} rsd</span><del> ${function(e,n){return e==n?"":e+" rsd"}(e.cena.stara,e.cena.nova)}</del>\n                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 ">\n                         <button id="korpa" class="korpa btn border border-dark" data-id="${e.id}" data-stanje="${e.naStanju}">dodaj u korpu</button>\n                    </div>\n            </div>\n          </div>\n        `}),document.getElementById("proizvodi").innerHTML=n,$(".korpa").click(DODAJuKORPU)}function prioritet(e){e.preventDefault();let n=this.dataset.prioritet,t=[];$.ajax({url:"data/proizvodi.json",method:"get",type:"json",success:function(e){ispis(t=e.filter(e=>e.prioritet==n))},error:function(e,n,t){console.log(t)}})}function ispisKategorija(){$.ajax({url:"data/kategorije.json",method:"get",type:"json",success:function(e){let n='<select id="kategorija"><option value="0">KATEGORIJE (sve)</option>';e.forEach(e=>{n+=`\n                <option value="${e.id}">\n                ${e.naziv}\n                </option>\n                `}),n+="</select>",$("#sortFilter").html(n),document.getElementById("kategorija").addEventListener("change",function(){filtriranjePoKategoriji(this.value)})},error:function(e,n,t){console.log(t)}})}function filtriranjePoKategoriji(e){$.ajax({url:"data/proizvodi.json",method:"get",type:"json",success:function(n){niz=0!=e?n.filter(function(n){return n.kategorija.id==e}):n.filter(e=>1==e.prioritet),ispis(niz)},error:function(e,n,t){console.log(t)}})}function pretragaProizvoda(e){let n=document.querySelector("#search").value,t=e.filter(function(e){return-1!==e.kategorija.naziv.toLowerCase().indexOf(n.toLowerCase())||(-1!==e.naziv.toLowerCase().indexOf(n.toLowerCase())||void 0)});t.length?(t.sort((e,n)=>e.cena.nova-n.cena.nova),ispis(t)):document.getElementById("proizvodi").innerHTML="<h1 class='w-100 text-center'>NEMA TAKVIH PROIZVODA!</h1><h5 class='w-100 text-center'>(probajte ponovo da upi≈°ete naziv proizvoda) </h5>"}function sortiranje(e){let n=document.getElementById("range1").value,t=document.getElementById("range2").value,o=$("#kategorija").val(),a=[];(a=(a=0!=o?e.filter(function(e){return e.kategorija.id==o}):e).filter(function(e){if(e.cena.nova>=n&&e.cena.nova<=t)return!0})).length?(a.sort((e,n)=>e.cena.nova-n.cena.nova),ispis(a)):document.getElementById("proizvodi").innerHTML="<h1 class='w-100 text-center'>NEMA TAKVIH PROIZVODA!</h1><h5 class='w-100 text-center'>(probajte ponovo da podesite cene i izaberete kategoriju) </h5>"}function range(){let e=document.getElementById("range1").value,n=document.getElementById("range2").value;document.getElementById("OfValeuPrice").innerHTML=e,document.getElementById("toValuePrice").innerHTML=n}function upisiUkorpu(){var e=PROIZVODIuKORPI();null==e&&(e=1);var n=e.length;$("#brojPorudz").html(n)}function PROIZVODIuKORPI(){return JSON.parse(localStorage.getItem("products"))}function DODAJuKORPU(){let e=$(this).data("id"),n=$(this).data("stanje");var t=PROIZVODIuKORPI();if(n)if(t)if(t.filter(n=>n.id==e).length){let n=PROIZVODIuKORPI();for(let t of n)if(t.id==e){t.kolicina++;break}localStorage.setItem("products",JSON.stringify(n))}else{let n=PROIZVODIuKORPI();n.push({id:e,kolicina:1}),localStorage.setItem("products",JSON.stringify(n))}else{let n=[];n[0]={id:e,kolicina:1},localStorage.setItem("products",JSON.stringify(n))}else alert("Proizvod trenutno nije na stanju!");upisiUkorpu()}$(document).ready(function(){$.ajax({url:"data/proizvodi.json",method:"get",type:"json",success:function(e){ispisProizvoda(e),document.querySelector("#search").addEventListener("input",function(){pretragaProizvoda(e)}),$("#sortiraj").click(function(){sortiranje(e)})},error:function(e,n,t){console.log(t)}}),ispisKategorija(),$("#prioritet a").click(prioritet),range(),$("[type=range]").change(range),upisiUkorpu()});